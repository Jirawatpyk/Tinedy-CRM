*# Story 1.1: Project Setup

<!-- Powered by BMAD™ Core -->

## Status
Done

## Story
**As a** Developer,
**I want** to set up the initial project structure for the React frontend and the backend services,
**so that** we have a clean and standardized foundation for development.

## Acceptance Criteria

1. A new monorepo is created containing separate packages for frontend and backend.
2. The frontend package is initialized with a new React (Next.js) application using TypeScript and Tailwind CSS.
3. The backend package is initialized with a basic serverless function structure.
4. Basic linting and formatting configurations are set up for both packages.
5. A basic "Hello World" or index page can be run successfully on the development server.

## Tasks / Subtasks

- [x] Set up monorepo structure (AC: 1)
  - [x] Create root package.json with workspace configuration
  - [x] Create pnpm-workspace.yaml for package management
  - [x] Set up apps/ and packages/ directories
- [x] Initialize main CRM application (AC: 2)
  - [x] Create apps/crm-app/ directory
  - [x] Initialize Next.js 14+ application with TypeScript
  - [x] Install and configure Tailwind CSS
  - [x] Install and configure shadcn/ui components
  - [x] Install Lucide React for icons
- [x] Set up backend serverless structure (AC: 3)
  - [x] Create app/api/ directory structure following source tree
  - [x] Set up basic API route structure for auth/, customers/, jobs/, webhook/
  - [x] Configure TypeScript for backend code
- [x] Configure development tooling (AC: 4)
  - [x] Set up ESLint configuration
  - [x] Set up Prettier configuration
  - [x] Configure TypeScript compiler options
  - [x] Set up shared types package structure
- [x] Create basic "Hello World" page (AC: 5)
  - [x] Create basic index page in app/page.tsx
  - [x] Ensure development server runs successfully
  - [x] Verify Tailwind CSS is working
  - [x] Test basic shadcn/ui component rendering

## Dev Notes

### Previous Story Insights
This is the first story in the project - no previous story context available.

### Project Structure Standards
**[Source: docs/Source Tree Structure.md]**
- **Monorepo Structure**: Use apps/ for applications and packages/ for shared code
- **Main Application**: apps/crm-app/ contains the Next.js application
- **API Structure**: app/api/ contains serverless function routes (auth/, customers/, jobs/, webhook/)
- **Components**: components/ui/ for shadcn/ui, components/shared/ for common components, components/forms/ for reusable forms
- **Utilities**: lib/ contains api-client.ts, db.ts, services/, and utils.ts
- **Shared Types**: packages/types/ for TypeScript types shared between frontend and backend

### Tech Stack Requirements
**[Source: docs/tech-stack.md]**
- **Frontend Framework**: Next.js ~14.x with React and TypeScript ~5.x
- **Styling**: Tailwind CSS ~3.x for styling framework
- **UI Components**: shadcn/ui & Radix UI (latest) for component library
- **Icons**: Lucide React (latest) for iconography
- **Package Management**: pnpm (monorepo workspace management)
- **Linting**: ESLint + Prettier for code formatting

### Development Configuration Standards
**[Source: docs/Implementation, Security, and Standards.md]**
- **Code Quality**: TypeScript is mandatory throughout the project
- **Formatting**: Prettier and ESLint must be configured for consistent code standards
- **Type Safety**: Shared types between frontend/backend via packages/types required
- **Repository Setup**: Follow Repository Pattern for data access through Service Layer

### File Locations for New Code
**[Source: docs/Source Tree Structure.md]**
- Root workspace files: package.json, pnpm-workspace.yaml, tsconfig.json
- Main app: apps/crm-app/package.json, apps/crm-app/app/page.tsx
- API structure: apps/crm-app/app/api/ (prepare folders but no implementation yet)
- Shared types: packages/types/index.ts
- Configuration files: .eslintrc, .prettierrc in appropriate locations

### Testing Standards

**[Source: docs/Implementation, Security, and Standards.md#testing-strategy]**
- **Frontend Testing**: Jest + React Testing Library for component testing
- **Backend Testing**: Vitest ~1.x for API/Logic testing
- **E2E Testing**: Playwright ~1.x for critical user workflow testing
- **Test Strategy**: Unit tests for important logic, integration tests for API-database connections
- **Test Coverage**: Components and Services must have unit test coverage

### Technical Constraints
**[Source: docs/tech-stack.md]**
- TypeScript version: ~5.x across all packages
- Next.js version: ~14.x for frontend framework
- Must use pnpm for package management (based on workspace config)
- No specific performance or security constraints for initial setup

### Testing
**[Source: docs/Implementation, Security, and Standards.md#testing-strategy]**
- **Test File Locations**: Create apps/crm-app/__tests__/ directory for test files
- **Frontend Testing Framework**: Jest + React Testing Library for component testing
- **Backend Testing Framework**: Vitest ~1.x for API/Logic testing
- **E2E Testing Framework**: Playwright ~1.x for end-to-end workflows
- **Initial Test Requirements**:
  - Create basic test for "Hello World" page component
  - Verify Next.js development server starts successfully
  - Test Tailwind CSS integration and shadcn/ui component rendering
- **Test Structure**: Follow standard Jest/Vitest patterns with .test.ts/.test.tsx extensions
- **Test Coverage**: Focus on essential functionality validation for this initial setup story

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-09-27 | 1.0 | Initial story creation | Bob (Scrum Master) |
| 2025-09-27 | 1.1 | Added Testing section and enhanced source references per PO validation | Bob (Scrum Master) |

## Dev Agent Record

### Agent Model Used
Claude Sonnet 4 (claude-sonnet-4-20250514)

### Debug Log References
No major debugging issues encountered. Minor configuration fixes required:
- Fixed Jest moduleNameMapper configuration typo
- Removed deprecated Next.js appDir experimental flag
- Simplified ESLint configuration to avoid TypeScript parser conflicts
- Applied Prettier formatting to resolve linting errors

### Completion Notes List
- Successfully implemented complete monorepo structure with pnpm workspaces
- Next.js 14+ application with TypeScript 5.x and Tailwind CSS 3.x integrated
- shadcn/ui component system established with basic Button component
- Comprehensive testing setup with Jest and React Testing Library
- All builds and tests passing (9/9 test cases successful)
- API route structure prepared for future implementation
- Code quality tooling (ESLint, Prettier) configured and working

### File List
**Root Level:**
- package.json - Root workspace configuration with pnpm
- pnpm-workspace.yaml - Workspace definition
- tsconfig.json - Root TypeScript project references

**Apps/CRM-App:**
- apps/crm-app/package.json - Main application dependencies
- apps/crm-app/next.config.js - Next.js configuration
- apps/crm-app/tsconfig.json - TypeScript configuration for app
- apps/crm-app/tailwind.config.js - Tailwind CSS configuration
- apps/crm-app/postcss.config.js - PostCSS configuration
- apps/crm-app/.eslintrc.json - ESLint configuration
- apps/crm-app/.prettierrc - Prettier configuration
- apps/crm-app/jest.config.js - Jest testing configuration
- apps/crm-app/jest.setup.js - Jest setup file

**Application Code:**
- apps/crm-app/app/layout.tsx - Root layout component
- apps/crm-app/app/page.tsx - Main "Hello World" page
- apps/crm-app/app/globals.css - Global styles with Tailwind
- apps/crm-app/components/ui/button.tsx - shadcn/ui Button component
- apps/crm-app/lib/utils.ts - Utility functions for styling

**API Routes:**
- apps/crm-app/app/api/auth/route.ts - Authentication API placeholder
- apps/crm-app/app/api/customers/route.ts - Customers API placeholder
- apps/crm-app/app/api/jobs/route.ts - Jobs API placeholder
- apps/crm-app/app/api/webhook/route.ts - N8N webhook API placeholder

**Testing:**
- apps/crm-app/__tests__/page.test.tsx - Tests for main page component
- apps/crm-app/__tests__/button.test.tsx - Tests for Button component

**Packages:**
- packages/types/package.json - Shared types package configuration
- packages/types/tsconfig.json - TypeScript configuration for types
- packages/types/index.ts - Shared TypeScript type definitions

## QA Results

### Review Date: 2025-09-27

### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment

Excellent implementation of the project setup story. The monorepo structure is properly established with clear separation of concerns. The Next.js 14+ application is correctly configured with TypeScript 5.x, Tailwind CSS 3.x, and shadcn/ui components. Code follows modern React patterns with proper TypeScript integration.

### Refactoring Performed

- **File**: jest.setup.js → jest.setup.ts
  - **Change**: Converted Jest setup to TypeScript and updated configuration
  - **Why**: Fixed TypeScript compilation errors for testing library matchers
  - **How**: Changed .js to .ts extension and updated jest.config.js reference

### Compliance Check

- Coding Standards: ✓ TypeScript mandatory throughout, proper linting/formatting
- Project Structure: ✓ Follows specified monorepo with apps/ and packages/ directories
- Testing Strategy: ✓ Jest + React Testing Library configured, all tests passing (9/9)
- All ACs Met: ✓ All 5 acceptance criteria fully implemented and verified

### Improvements Checklist

- [x] Fixed TypeScript configuration issues in test setup (jest.setup.ts)
- [x] Verified all builds and tests pass (9/9 test cases successful)
- [x] Confirmed linting and type checking work correctly
- [x] Validated shadcn/ui Button component implementation
- [x] Verified API route structure follows specification
- [ ] Consider adding environment configuration for different deployment stages
- [ ] Consider adding basic error boundary for production resilience

### Security Review

No security concerns at this foundation level. API routes are placeholder implementations only, which is appropriate for this setup story. Future stories should implement proper authentication and input validation.

### Performance Considerations

Build output is optimal with good bundle splitting (87.3kB first load). Tailwind CSS is properly configured with purging. Static generation working correctly.

### Files Modified During Review

- jest.setup.ts (created, replaced jest.setup.js)
- jest.config.js (updated to reference TypeScript setup file)

### Gate Status

Gate: PASS → docs/qa/gates/1.1-project-setup.yml
Risk profile: Low risk - foundational setup with comprehensive testing
NFR assessment: All NFRs appropriate for setup story

### Recommended Status

✓ Ready for Done
All acceptance criteria met, comprehensive test coverage, builds successfully, follows all specified standards.